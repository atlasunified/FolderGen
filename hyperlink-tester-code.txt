' HYPERLINK TESTER
' This VBA code takes the information in the 'Product Number' Page and offsets 
' the linked information in the cell into the 'Hyperlinks' comlumn.
' If your're a developer, manipulating this information is easy. If you're a
' novice, chances are you aren't reading this, but if you are, just modify the
' information within the rows themselves and keep a mental note of what the data
' represents.

' Atlas Unified

Sub TestLinksInRange()

Dim xhr As Object
Dim urlRange As Range
Dim urlCell As Range
Dim startCell As Range
Dim finishCell As Range

Set xhr = CreateObject("MSXML2.XMLHTTP")
Set startCell = Range("D4")
Set finishCell = Range("E4")
Set urlRange = Range(startCell, finishCell)

For Each urlCell In urlRange
    xhr.Open "GET", urlCell.Value, False
    xhr.send
    
    If xhr.Status = 200 Then
        urlCell.Offset(0, 1).Value = "200" 'Write "200" to cell next to URL
    Else
        urlCell.Offset(0, 1).Value = "400" 'Write "400" to cell next to URL
    End If
Next urlCell

MsgBox "Link Testing Complete!"